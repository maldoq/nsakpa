{% extends 'base/website/base.html' %}
{% load static %}

{% block title %}{{ artisan.name }} | N'Sapka{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/website/artisans.css' %}">

<!-- Hero de l'artisan -->
<section class="artisans-hero" style="background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('{% if artisan.banner %}{{ artisan.banner.url }}{% else %}{% static 'img/website/artisans-hero-bg.jpg' %}{% endif %}') center/cover no-repeat;">
    <div class="container">
        <h1>{{ artisan.name }}</h1>
        <p>{{ artisan.tagline|default:"Artisan talentueux préservant et innovant les traditions artisanales africaines" }}</p>
    </div>
</section>

<!-- Détail de l'artisan -->
<section class="artisan-detail">
    <div class="container">
        <div class="artisan-content">
            <div class="artisan-image">
                <img src="{% if artisan.image %}{{ artisan.image.url }}{% else %}{% static 'img/website/dushawn-jovic-lrFElEb4vFI-unsplash.jpg' %}{% endif %}" alt="{{ artisan.name }}">
                <div class="craft-tag">{{ artisan.craft_type.name|default:"Artisanat" }}</div>
            </div>

            <div class="artisan-info">
                <p><strong>Région:</strong> {{ artisan.region.name|default:"Non spécifiée" }}</p>
                <p><strong>Pays:</strong> {{ artisan.country }}</p>
                
                {% if artisan.story %}
                <p><strong>Histoire:</strong> {{ artisan.story }}</p>
                {% endif %}
                
                <p><strong>Description:</strong> {{ artisan.description }}</p>
                
                {% if artisan.specialty %}
                <p><strong>Spécialité:</strong> {{ artisan.specialty }}</p>
                {% endif %}
                
                <div class="artisan-rating">
                    <strong>Note:</strong>
                    {% for i in "12345" %}
                        {% if forloop.counter0 < artisan.rating|floatformat:0 %}
                            <i class="fas fa-star"></i>
                        {% elif forloop.counter0 < artisan.rating %}
                            <i class="fas fa-star-half-alt"></i>
                        {% else %}
                            <i class="far fa-star"></i>
                        {% endif %}
                    {% endfor %}
                    <span>({{ artisan.rating }})</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Produits de l'artisan -->
{% if products %}
<section class="artisan-products">
    <div class="container">
        <h2>Créations de {{ artisan.name }}</h2>
        
        <div class="products-grid">
            {% for product in products %}
            <article class="product-card">
                <a href="{% url 'product_detail' product.id %}" class="product-link">
                    <div class="product-image">
                        {% if product.media.exists %}
                        <img src="{{ product.media.first.file.url }}" alt="{{ product.name }}" loading="lazy">
                        {% else %}
                        <img src="{% static 'img/website/placeholder-product.jpg' %}" alt="{{ product.name }}" loading="lazy">
                        {% endif %}

                        {% if product.featured %}
                        <div class="featured-badge">
                            <i class="fas fa-star"></i> Vedette
                        </div>
                        {% endif %}
                    </div>

                    <div class="product-info">
                        <h3 class="product-title">{{ product.name }}</h3>
                        
                        {% if product.description %}
                        <p class="product-description">{{ product.description|truncatechars:100 }}</p>
                        {% endif %}

                        <div class="product-details">
                            <div class="product-price">
                                <span class="current-price">{{ product.price }} F CFA</span>
                            </div>

                            <div class="product-stock">
                                <i class="fas fa-check"></i> En stock
                            </div>
                        </div>
                    </div>
                </a>

                <button onclick="addToCart(
                    {{ product.id }}, 
                    '{{ product.name|escapejs }}', 
                    {{ product.price }}, 
                    '{% if product.media.exists %}{{ product.media.first.file.url }}{% else %}{% static 'img/website/placeholder-product.jpg' %}{% endif %}',
                    {{ product.stock }}
                )" class="add-to-cart-btn">
                    <i class="fas fa-shopping-cart"></i>
                    Ajouter au panier
                </button>
            </article>
            {% endfor %}
        </div>
        
        <div class="section-footer">
            <a href="{% url 'products' %}?artisan={{ artisan.id }}" class="view-all-btn">
                Voir toutes les créations
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- Contacter l'artisan -->
<section class="artisan-contact">
    <div class="container">
        <div class="contact-artisan">
            <h3>Contacter {{ artisan.name }}</h3>
            
            <form class="contact-form" method="post" action="{% url 'contact_artisan' artisan.id %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="name">Votre nom</label>
                    <input type="text" id="name" name="name" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Votre email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="subject">Sujet</label>
                    <input type="text" id="subject" name="subject" required>
                </div>
                
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                
                <button type="submit">
                    <i class="fas fa-paper-plane"></i>
                    Envoyer le message
                </button>
            </form>
        </div>
    </div>
</section>

<!-- Autres artisans similaires -->
{% if similar_artisans %}
<section class="similar-artisans">
    <div class="container">
        <h2>Artisans similaires</h2>
        
        <div class="artisans-grid">
            {% for similar in similar_artisans %}
            <div class="artisan-card">
                <div class="artisan-image">
                    <img src="{% if similar.image %}{{ similar.image.url }}{% else %}{% static 'img/website/placeholder-artisan.jpg' %}{% endif %}" alt="{{ similar.name }}">
                    <div class="craft-tag">{{ similar.craft_type.name|default:"Artisanat" }}</div>
                </div>
                
                <div class="artisan-info">
                    <h3>{{ similar.name }}</h3>
                    
                    <div class="artisan-location">
                        <i class="fas fa-map-marker-alt"></i>
                        {{ similar.region.name|default:similar.country }}
                    </div>
                    
                    <p class="artisan-description">{{ similar.description|truncatechars:120 }}</p>
                    
                    <div class="artisan-footer">
                        <a href="{% url 'artisan_detail' similar.id %}" class="btn-view-profile">
                            <i class="fas fa-user"></i>
                            Voir le profil
                        </a>
                        
                        <div class="artisan-rating">
                            {% for i in "12345" %}
                                {% if forloop.counter0 < similar.rating|floatformat:0 %}
                                    <i class="fas fa-star"></i>
                                {% else %}
                                    <i class="far fa-star"></i>
                                {% endif %}
                            {% endfor %}
                            <span>({{ similar.rating }})</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

{% endblock %}


{% comment %} {% extends 'base.html' %}
{% load static %}

{% block title %}{{ artisan.name }} | N'Sapka{% endblock %}

{% block content %}
<section class="artisan-detail">
    <div class="container">
        <h1>{{ artisan.name }}</h1>
        <div class="artisan-content">
            <div class="artisan-image">
                <img src="{{ artisan.image.url }}" alt="{{ artisan.name }}">
                <div class="craft-tag">{{ artisan.craft_type.name|default:"Non spécifié" }}</div>
            </div>
            <div class="artisan-info">
                <p><strong>Région:</strong> {{ artisan.region.name|default:"Non spécifiée" }}</p>
                <p><strong>Pays:</strong> {{ artisan.country }}</p>
                <p><strong>Description:</strong> {{ artisan.description }}</p>
                <div class="artisan-rating">
                    <strong>Note:</strong>
                    {% for i in "12345" %}
                        {% if forloop.counter0 < artisan.rating|floatformat:0 %}
                            <i class="fas fa-star"></i>
                        {% elif forloop.counter0 < artisan.rating %}
                            <i class="fas fa-star-half-alt"></i>
                        {% else %}
                            <i class="far fa-star"></i>
                        {% endif %}
                    {% endfor %}
                    <span>({{ artisan.rating }})</span>
                </div>
                <!-- Add links to artisan's products or other details -->
            </div>
        </div>
    </div>
</section>
{% endblock %} {% endcomment %}